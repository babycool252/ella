{{ 'component-header-verdura.css' | asset_url | stylesheet_tag }}

<header class="header-verdura" role="banner">
  <div class="header-verdura__container">
    <!-- 左侧 MENU -->
    <div class="header-verdura__left">
      <button class="header-verdura__menu-button" type="button" aria-label="Open menu">
        <span class="header-verdura__menu-text">MENU</span>
      </button>
    </div>

    <!-- 中间 VERDURA LOGO -->
    <div class="header-verdura__center">
      <a href="{{ routes.root_url }}" class="header-verdura__logo-link">
        <!-- 皇冠图标 -->
        <div class="header-verdura__crown">
          <svg width="40" height="24" viewBox="0 0 40 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <!-- 皇冠底部 -->
            <rect x="2" y="18" width="36" height="4" fill="currentColor"/>
            <!-- 皇冠尖峰 -->
            <path d="M20 2L16 14L8 12L6 16L12 16L16 16L20 16L24 16L28 16L34 16L32 12L24 14L20 2Z" fill="currentColor"/>
            <!-- 左侧尖峰 -->
            <path d="M6 8L10 14L14 12L12 16L6 16L6 8Z" fill="currentColor"/>
            <!-- 右侧尖峰 -->
            <path d="M34 8L34 16L28 16L26 12L30 14L34 8Z" fill="currentColor"/>
            <!-- 宝石装饰 -->
            <circle cx="20" cy="10" r="1.5" fill="currentColor"/>
            <circle cx="12" cy="13" r="1" fill="currentColor"/>
            <circle cx="28" cy="13" r="1" fill="currentColor"/>
          </svg>
        </div>
        
        <!-- VERDURA 文字 -->
        <div class="header-verdura__logo-text">
          <span class="header-verdura__brand-name">VERDURA</span>
          <span class="header-verdura__established">EST. 1939</span>
        </div>
      </a>
    </div>

    <!-- 右侧 CART -->
    <div class="header-verdura__right">
      <a href="{{ routes.cart_url }}" class="header-verdura__cart-link" aria-label="Shopping cart">
        <span class="header-verdura__cart-text">CART (</span>
        <span class="header-verdura__cart-count" data-cart-count="{{ cart.item_count }}">{{ cart.item_count }}</span>
        <span class="header-verdura__cart-text">)</span>
      </a>
    </div>
  </div>
</header>

<!-- 移动端菜单抽屉 -->
<div class="header-verdura__menu-drawer" data-menu-drawer>
  <div class="header-verdura__menu-overlay" data-menu-overlay></div>
  <div class="header-verdura__menu-content">
    <div class="header-verdura__menu-header">
      <span class="header-verdura__menu-title">Menu</span>
      <button class="header-verdura__menu-close" data-menu-close aria-label="Close menu">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <path d="M15 5L5 15M5 5L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
    
    <nav class="header-verdura__navigation">
      {% for link in linklists.main-menu.links %}
        <a href="{{ link.url }}" class="header-verdura__nav-link">{{ link.title }}</a>
      {% endfor %}
    </nav>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const menuButton = document.querySelector('.header-verdura__menu-button');
  const menuDrawer = document.querySelector('.header-verdura__menu-drawer');
  const menuOverlay = document.querySelector('.header-verdura__menu-overlay');
  const menuClose = document.querySelector('.header-verdura__menu-close');

  function openMenu() {
    menuDrawer.classList.add('header-verdura__menu-drawer--open');
    document.body.classList.add('header-verdura__menu-open');
  }

  function closeMenu() {
    menuDrawer.classList.remove('header-verdura__menu-drawer--open');
    document.body.classList.remove('header-verdura__menu-open');
  }

  if (menuButton) {
    menuButton.addEventListener('click', openMenu);
  }

  if (menuOverlay) {
    menuOverlay.addEventListener('click', closeMenu);
  }

  if (menuClose) {
    menuClose.addEventListener('click', closeMenu);
  }

  // 监听购物车更新
  document.addEventListener('cart:changed', function(event) {
    const cartCount = document.querySelector('.header-verdura__cart-count');
    if (cartCount && event.detail) {
      cartCount.textContent = event.detail.item_count || 0;
    }
  });
});
</script>
